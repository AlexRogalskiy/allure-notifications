plugins {
    id 'java-library'
}

group 'allure.notifications'
version '4.1'

sourceCompatibility = 1.8

repositories {
    mavenCentral()
}

dependencies {

    def slf4j_version = "1.7.36"
    def javax_mail_version = "1.6.2"
    def unirest_version = '3.13.10'
    def freemarker_version = "2.3.31"
    def xchart_version = '3.8.1'
    def jsonpath_version = "2.7.0"
    def commons_io_version = '20030203.000550'
    def log4j_version = "2.7.1"
    def lombok = "1.18.24"
    def junit_jupiter = "5.7.0"

    implementation(
            "org.slf4j:slf4j-log4j12:$slf4j_version",
            "com.sun.mail:javax.mail:$javax_mail_version",
            "com.konghq:unirest-java:$unirest_version",
            "org.freemarker:freemarker:$freemarker_version",
            "org.knowm.xchart:xchart:$xchart_version",
            "com.jayway.jsonpath:json-path:$jsonpath_version",
            "commons-io:commons-io:$commons_io_version",

            compileOnly("org.springframework.boot:spring-boot-starter-log4j2:$log4j_version"),
            annotationProcessor("org.projectlombok:lombok:$lombok"),
            compileOnly("org.projectlombok:lombok:$lombok"),
            implementation("org.junit.jupiter:junit-jupiter:$junit_jupiter"),
            implementation('org.apache.commons:commons-lang3:3.12.0'),

    )
    testImplementation 'org.springframework.boot:spring-boot-starter-test:2.7.1'
    implementation 'org.springframework:spring-context:5.3.21'
    testImplementation 'org.mockito:mockito-all:1.10.19'

}

tasks.withType(JavaCompile) {
    System.getProperties()
    options.encoding = 'UTF-8'
}
tasks.named('test') {
    useJUnitPlatform()
}

jar {
    manifest {
        attributes(
                'Main-Class': 'guru.qa.allure.notifications.Application'
        )
    }
    from {
        configurations.runtimeClasspath.collect { it.isDirectory() ? it : zipTree(it) }
    }
    duplicatesStrategy = DuplicatesStrategy.WARN
}
